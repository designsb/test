
/* ----------------- *
 * SolutionsJS       *
 * Version: 2.3.3    *
 * Updated: 11/29/16 *
 * ----------------- */

/*
 * The information and software code below,
 * located at http://cdn.invoca.solutions/js/pnapi_integration-2.3.3.min.js,
 * are confidential and are the sole property of Invoca.
 * Your application or use of this information in any way is subject to
 * Invoca's Terms of Service, which are located at
 * http://www.invoca.com/terms-of-service/. In accordance with those terms, your
 * use of this information and code may be terminated by Invoca at any time
 * for any reason.  The rights granted to you under those terms are expressly
 * non-exclusive. You may not sell, assign, sublicense, or otherwise transfer or
 * agree to transfer all or any portion of those rights without Invoca's
 * prior written consent.  You agree not to copy, republish, frame, download,
 * transmit, modify, rent, lease, loan, sell, assign, distribute, license,
 * sublicense, reverse engineer, or create derivative works based on the
 * information and/or software code on this page except as expressly authorized
 * in Invoca's Terms of Service.  Your use and continued use of this
 * information and/or code constitute your acceptance of Invoca's Terms of Service.
 *
 * Copyright (c) 2016 Invoca (r)
 */

if("undefined"==typeof Invoca)var Invoca={};Invoca.PNAPI={loaded:!1},Invoca.PNAPI.config={URL:"//pnapi.invoca.net/PARTITION/api/VERSION_KEY/map_number.jsonp"},Invoca._RequestData={},Invoca._PoolParams={},Invoca.Tools={},Invoca.PNAPI=Invoca.PNAPI||{},Invoca._DOM=Invoca._DOM||{DEFAULT_SELECTOR:".invocaNumber",DATA_ATTR_NAME:"data-invoca-campaign-id",DESTINATION_ATTR_NAME:"data-invoca-destination-id",VANITY_NUMBER_REGEX:new RegExp("(\\(|\\))?([0-9]){3}([\\s|\\-|\\.|\\(|\\)])?([\\s\\-\\.\\(\\))(\\-\\.\\(\\)])?([a-z0-9\\-\\.\\s]){7,8}","gi"),PHONE_NUMBER_REGEX:new RegExp("(\\(|\\))?([0-9]){3}(\\s|\\-|.|\\(|\\))?([\\s|\\-|\\.|\\(|\\))(\\-|\\.|\\(|\\)])([0-9]){3}([\\s|\\-|\\.|\\(|\\))(\\-|\\.|\\(|\\)])([0-9]){4}","gi"),numberToReplaceHasRun:!1},Invoca._Refresh={defaultWaitTimeSeconds:50,averageWaitTimeSeconds:null,active:!0,firstRun:!0,oldBlur:window.onblur,oldFocus:window.onfocus},Invoca._Cache={localStorageAvailable:!!window.localStorage,sessionCanBeReset:!0,shouldCheckOldCookie:!0,ready:!1},Invoca.PNAPI.currentPageSettings={cookieDays:1,telLinkOnly:!1,destinationAsId:!1,refresh:!0,campaignIdOverrideParam:null,defaultCampaignId:null,onCompleteOverride:null,requiredParams:{},poolParams:null,updatePoolParams:!0,debugMode:!1,useLocalStorage:!1,cookieNames:[]},Invoca.location=window.location.href,Invoca.search=window.location.search,Invoca.referrer=document.referrer,Invoca.domain=document.domain,Invoca.userAgent=navigator.userAgent,Invoca.now=function(){return(new Date).getTime()},Invoca.log=function(a,b){"undefined"!=typeof console&&(b&&"undefined"!=typeof console.error?console.error(a):Invoca.PNAPI.currentPageSettings.debugMode&&"undefined"!=typeof console.log&&console.log(a))},Invoca.PNAPI.ALLOWED_VERSIONS=["2014-09-01"],Invoca.PNAPI.requestPromoNumbers=function(a){function b(b){Invoca.log("Invoca.PNAPI.requestPromoNumbers onResponse triggered. Response data below:"),Invoca.log(b),a.context?a.onComplete.apply(a.context,[c,b]):a.onComplete(c,b)}if(!Invoca.PNAPI.settings)return void Invoca.log("ERROR: Invoca.PNAPI.settings must be set before calling Invoca.PNAPI.requestPromoNumbers",!0);if(Invoca.PNAPI.setConfig(Invoca.PNAPI.settings),!a.onComplete)return void Invoca.log("Invoca.PNAPI.requestPromoNumbers: onComplete callback is required",!0);if(!a.requestData||0===a.requestData.length)return void Invoca.log("Invoca.PNAPI.requestPromoNumbers: requestData is required and must not be empty",!0);if(!Invoca.PNAPI.config.networkId)return void Invoca.log("ERROR: networkId must be set before calling Invoca.PNAPI.requestPromoNumbers",!0);var c=a.batchId||(new Date).getTime(),d={network_id:Invoca.PNAPI.config.networkId,request_data_shared_params:Invoca.JSON.stringify(a.requestDataSharedParams||{}),request_data:Invoca.JSON.stringify(a.requestData)},e=(window.location.protocol+Invoca.PNAPI.config.URL).replace(/VERSION_KEY/,Invoca.PNAPI.config.version);e=e.replace(/PARTITION/,(parseInt(Invoca.PNAPI.config.networkId)||0)%16);var f=new Invoca.JSONP.requestWithLandingPage(e,d,"url",{},"",b);f.get()},Invoca.PNAPI.swapNumber=function(a,b){var c=new Invoca.PhoneNumber(b.countryCode||b,b.nationalNumber),d=new Invoca.PhoneNumber(a);return c.formatFromOther(a,d)},Invoca.PNAPI.transformRequestNumberResponseToHash=function(a){for(var b={},c=0;c<a.length;c++)b[a[c].requestId]=a[c];return b},Invoca.PNAPI.getQueryStringHash=function(a){for(var b={},c=a.substr(1).split("&"),d=0;d<c.length;++d){var e=c[d].split("=");b[e[0].toLowerCase()]=e[1]}return b},Invoca.PNAPI.getReferrer=function(){return document.referrer},Invoca.PNAPI.setConfig=function(a,b){function c(a,b){return"undefined"==typeof a?b:a}if(!Invoca.PNAPI.config.version){var d=Invoca.PNAPI.getQueryStringHash(window.location.search);Invoca.PNAPI.config.networkId=a.networkId,Invoca.PNAPI.config.version=c(a.version,Invoca.PNAPI.ALLOWED_VERSIONS[0]),Invoca.debugMode=c(a.debug,"1"===d.rr_debug)}},function(Invoca){function f(a){return a<10?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;c<f;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;c<f;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}Invoca.JSON=window.JSON||{},"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof Invoca.JSON.stringify&&(Invoca.JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;d<c;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof Invoca.JSON.parse&&(Invoca.JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(Invoca),function(a){var b,c,d=this;a.JSONP=a.JSONP||{},a.JSONP.counter=0,a.JSONP.load=function(a){var c=document.createElement("script"),d=!1;c.src=a,c.async=!0,c.onload=c.onreadystatechange=function(){d||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(d=!0,c.onload=c.onreadystatechange=null,c&&c.parentNode&&c.parentNode.removeChild(c))},b||(b=document.getElementsByTagName("head")[0]),b.appendChild(c)},a.JSONP.requestWithLandingPage=function(b,e,f,g,h,i){var j=!1;return h&&h.search(/%ESCAPED_URL%/)!==-1&&(j=!0),{get:function(){var b="json_rr"+ ++a.JSONP.counter;return d[b]=function(a){i(a);try{delete d[b]}catch(c){}d[b]=null},e.jsoncallback=b,a.JSONP.load(this.encodeUrl(),i),b},encodeUrl:function(){var a=b.search(/\?/)===-1?"?":"&";for(c in e)e.hasOwnProperty(c)&&(a+=encodeURIComponent(c)+"="+encodeURIComponent(e[c])+"&");return b=this.encodeVal(b+a,j?1:0),b+=f+this.encodeVal("=",j?1:0)+this.buildLandingPageUrl(),h?j?h.replace(/%ESCAPED_URL%/,b):h.replace(/%UNESCAPED_URL%/,b):b},buildLandingPageUrl:function(){var a=Invoca.location,b="",d="";if(g){b=a.search(/\?/)===-1?"?":"&";for(c in g)if(g.hasOwnProperty(c)){var e,f,h=g[c];"object"==typeof h?(e="undefined"==typeof h.escape||h.escape,f=h.value):(e=!0,f=h.toString()),d+=this.encodeVal(c,j?3:2)+this.encodeVal("=",j?2:1)+(e?this.encodeVal(f,j?3:2):f)+this.encodeVal("&",j?2:1)}d=d.replace(j?/(%2526)$/:/(%26)$/,"")}return this.encodeVal(a+b,j?2:1)+d},encodeVal:function(a,b){for(var c=a,d=0;d<b;++d)c=encodeURIComponent(c);return c}}}}(Invoca),function(a){function b(a){var b=/[^\d]/g,c=a.replace(b,"");return c}var c="-",d=" ",e="1",f="0";a.NANP_COUNTRY_CODE=e,a.PhoneNumber=function(g,h){var i=b(h?g:""),j=b(h?h:g),k=h?h:g;if(!i)if(11===j.length&&j.charAt(0)===e)i=e,j=j.substr(1);else if(10===j.length&&j.charAt(0)!==f)i=e;else if("+"===g.charAt(0)||"0"===g.charAt(0)){var l=/[\+|0]([\d]{1,2})[^\d]/g,m=g.match(l);if(m){var n=m[0].replace(/^\s+|\s+$/g,"");i=n.substr(1),j=j.substr(i.length)}else a.log("When prefixing a number with + or 0, include a non digit character after the country code")}i===e&&10!==j.length&&a.log("Invalid number: "+i+", "+k,!0),this.format=function(a,b,e){var f;if(this.isNANP()){f=e||c;var g=j.slice(0,3),h=j.slice(3,6),k=j.slice(6),l=g+f+h+f+k;return a&&(l="1"+f+l),l}return f=e||d,(b&&i?"+"+i+f:"")+j},this.formatFromOriginal=function(a,b){var f="",g=/[\s-]/g,h="";return this.isNANP()?(f=b||c,h=k.replace(g,f),a&&"+"!==h.charAt(0)&&(h=e+f+h)):(f=b||d,h=k.replace(g,f)),h},this.isNANP=function(){return i===e},this.isEmpty=function(){return!j},this.toParam=function(){return i===e?j:"00"+i+j},this.toString=function(){return this.format(!0)},this.countryCode=i,this.nationalNumber=j;var o="([^0-9]{0,10})",p="([([])?";this.to_replacement_regex=function(){var a="";"0"===j.charAt(0)?a+="([([]?0[^0-9]{0,10})?"+p:a="(1[^0-9]{0,10})?"+p+j.charAt(0)+o;for(var b=1;b<j.length;b++)a+=b===j.length-1?j.charAt(b):j.charAt(b)+o;return new RegExp(a,"gi")},this.formatFromOther=function(a,b){var c=b.to_replacement_regex().exec(a);if(null===c)return a;for(var d="",e="0"===j.charAt(0)?1:0,f=1;f<=c.length+1;f++)"undefined"!=typeof c[f]&&(d+=c[f]),f>1&&(d+=j.charAt(e),e++);return d}}}(Invoca),Invoca.Tools.readInvocaData=function(a,b){b=b||null,Invoca._Cache.initialize();var c=Invoca._Cache.get("config"),d=c?Invoca.Tools.readUrl(c.campaignIdOverrideParam):null,e=Invoca._Cache.get("session");return d?b:e?e[a]||b:b},Invoca.Tools.parseReferrer=function(a,b,c,d){if(d=d||"contains",c&&"string"==typeof c)c=c||Invoca.referrer;else{if(c)throw"Invoca.Tools.parseReferrer: objectToParse must be a string";c=Invoca.referrer}if(b||(Invoca.PNAPI.warn("No defaultId passed to Invoca.PNAPI.parseReferrer: Returning null if no campaign found."),b=null),0===Invoca.PNAPI.getKeys(a).length)return b;if(""===Invoca.referrer&&a[""])return a[""];var e,f=Invoca.PNAPI.getKeys(a),g=c,h={contains:function(b,c){if(Invoca.Tools.contains(c,b))return a[b]},topLevelDomain:function(b,c){if(Invoca.Tools.trueDomain(c).slice(1)===b)return a[b]},subDomain:function(b,c){if(Invoca.Tools.getFullDomain(c)===b&&""!==b)return a[b]}};for(var i in f)if(e=f[i],matchFound=h[d](e,g))return matchFound;return b},Invoca.Tools.getFullDomain=function(a){var b=new RegExp("^https?://","g"),c=a.match(b);c||(a="http://"+a);var d=document.createElement("a");return d.href=a,d.hostname.replace("www.","")},Invoca.Tools.contains=function(a,b){return a.indexOf(b)>-1},Invoca.Tools.readUrl=function(a){return decodeURIComponent((new RegExp("[?|&]"+a+"=([^&;]+?)(&|#|;|$)").exec(Invoca.search)||[,""])[1].replace(/\+/g,"%20"))||null},Invoca.Tools.trueDomain=function(a){function b(a){a.match(new RegExp(/\.[a-z]{2,3}\.[a-z]{2}$/i))?a=a.replace(new RegExp(/\.[a-z]{2,3}\.[a-z]{2}$/i),""):a.match(new RegExp(/\.[a-z]{2,4}$/i))&&(a=a.replace(new RegExp(/\.[a-z]{2,4}$/i),""));var b=!!a.match(new RegExp(/\./g))&&a;return b}function c(a){return a=a.split("?")[0].replace(new RegExp(/^\s+/),""),a=a.replace(new RegExp(/\s+$/),""),a=a.replace(new RegExp(/\\/g),"/"),a=a.replace(new RegExp(/^http\:\/\/|^https\:\/\/|^ftp\:\/\//i),""),a=a.replace(new RegExp(/^www\./i),""),a=a.replace(new RegExp(/\/(.*)/),""),"."+a}function d(a){return 4===a.split(".").length&&a.match(/\..*(\.([a-zA-Z]{2,3})){2}/g)}function e(a){var b,c=a.split("."),e=!d(a)&&c.length>=4;if(e){var f=c.length-1;b="."+c[f-1]+"."+c[f]}return b||null}function f(a){var b=a.split("."),c=b.length-3,f=b.length-1,g="";if(3===b.length&&""===b[0]||d(a))return a;for(;b[f-1]&&f>=c&&(g="."+b[f]+g,!d(g));)f--;return e(g)||g}a=a||Invoca.domain;var g=c(a);return b(g)?f(g):g},Invoca.Tools.readCookie=function(a){for(var b,c,d=document.cookie.split("; "),e=d.length-1;e>=0;e--)if(b=d[e],c=b.split("="),c[0]===a)return c[1];return null},Invoca.Tools.setCookie=function(a,b,c){var d=new Date;d.setTime(d.getTime()+24*c*60*60*1e3);var e="expires="+d.toUTCString(),f="path=/",g="domain="+Invoca.Tools.trueDomain();document.cookie=a+"="+b+"; "+e+"; "+f+"; "+g},Invoca.Tools.getQueryStringsHash=function(){for(var a={},b=Invoca.search.slice(1).split("&"),c=b.length-1;c>=0;c--){var d=b[c].split("=");""!==d[0]&&(a[d[0].toLowerCase()]=decodeURIComponent(d[1]))}return a},Invoca.Tools.deviceType=function(){return window.screen.width<766&&/Android|webOS|iPhone|BlackBerry|IEMobile/i.test(Invoca.userAgent)?"mobile":window.screen.width>766&&/Android|webOS|iPad/i.test(Invoca.userAgent)?"tablet":window.screen.width>766?"desktop":"unknown"},Invoca.Tools.isMobile=function(){var a=Invoca.Tools.deviceType();return"desktop"!==a&&"unknown"!==a},Invoca.Tools.waitFor=function(a,b,c,d){function e(){var h=a();return h?void b(h):(f++,f*g>=d?void b(c):void setTimeout(e,g))}d=d||1e3,c=c||null;var f=0,g=10;e()},Invoca._DOM.find=function(a){var b=[],c=a.split(",");return Invoca.PNAPI.forEach(c,function(a,c){var d=Invoca._DOM.getElements(a.replace(" ",""));Invoca.PNAPI.forEach(d,function(a,c){a&&b.push(a)})}),b},Invoca._DOM.getElements=function(a){function b(a){var b=[],c=document.getElementsByTagName("*"),d=0;return Invoca.PNAPI.forEach(c,function(e,f){if(e.className&&8!==e.nodeType){var g=e.className.split(" ");Invoca.PNAPI.forEach(g,function(e,f){e===a&&b.push(c[d])})}d++}),b}function c(a,b){return a.indexOf(b)&&a.split(b).length-1===1}var d=[];return c(a,".")?d=document.getElementsByClassName?document.getElementsByClassName(a.slice(1)):b(a.slice(1)):c(a,"#")?d.push(document.getElementById(a.slice(1))):Invoca.Tools.contains(a,".")||Invoca.Tools.contains(a,"#")||(d=document.getElementsByTagName(a)),0===d.length&&document.querySelectorAll&&(d=document.querySelectorAll(a)),0===d.length&&Invoca.PNAPI.warn('SolutionsJS Warning: Element "'+a+'" was not found or is not supported.'),d},Invoca._DOM.replaceNumbers=function(a,b){function c(a,b,c){c&&!Invoca.PNAPI.currentPageSettings.telLinkOnly&&(a.innerHTML=l.replace(b,c)),Invoca._DOM.updateTel(a,i)}function d(a){var b=new RegExp("[^a-zA-Z0-9\\(\\)\\s]","i"),c=a.match(b),d=c&&c[0]?c[0]:null;return d?d:"-"}var e,f,g,h,i=b,j=a.textContent||a.innerText,k=j.match(Invoca._DOM.PHONE_NUMBER_REGEX),l=a.innerHTML;k?(e=j,f=Invoca.PNAPI.swapNumber(e,e),g=Invoca.PNAPI.swapNumber(f,i)):(vanityNumber=a.innerText.match(Invoca._DOM.VANITY_NUMBER_REGEX))&&(f=vanityNumber[0],h=d(f),g=i.replace(/\-/g,h)),c(a,f,g)},Invoca._DOM.updateTel=function(a,b){a.href?a.href="tel:"+b:"undefined"!=typeof a.parentNode.href?a.parentNode.href="tel:"+b:Invoca.PNAPI.log("No tel: links updated because none were found.")},Invoca._DOM.numberToReplace=function(){if(Invoca.PNAPI.currentPageSettings.numberToReplace&&!Invoca._DOM.numberToReplaceHasRun){var a=Invoca.PNAPI.currentPageSettings.numberToReplace.constructor===Object,b=function(b){var c=document.createElement("span");return textNode=document.createTextNode(b),a&&c.setAttribute(Invoca._DOM.DATA_ATTR_NAME,Invoca.PNAPI.currentPageSettings.numberToReplace[b]),c.className=Invoca._DOM.DEFAULT_SELECTOR.slice(1),c.appendChild(textNode),c},c=function(a){var c=new Invoca.PhoneNumber(a),d=c.to_replacement_regex();Invoca._DOM.findAndReplaceText(d,document.documentElement,b)};if(a)Invoca.PNAPI.forEach(Invoca.PNAPI.currentPageSettings.numberToReplace,function(a,b,d){c(a)});else if("string"==typeof Invoca.PNAPI.currentPageSettings.numberToReplace){var d=Invoca.PNAPI.currentPageSettings.numberToReplace,e=d.split(",");Invoca.PNAPI.forEach(e,function(a,b){c(a)})}else Invoca.warn("numberToReplace setting is an invalid format. http://developers.invoca.net/en/2016-05-01/web_integration/pnapi_web_integration.html#client-side-parameters.");Invoca._DOM.numberToReplaceHasRun||(Invoca.PNAPI.currentPageSettings.numberSelector?Invoca.PNAPI.currentPageSettings.numberSelector+=", "+Invoca._DOM.DEFAULT_SELECTOR:Invoca.PNAPI.currentPageSettings.numberSelector=Invoca._DOM.DEFAULT_SELECTOR,Invoca._DOM.numberToReplaceHasRun=!0)}},Invoca._DOM.dataset=function(a,b){return"object"==typeof a&&a.getAttribute?a.getAttribute(b)||null:null},function(a){function b(b,f,g){var h,i,j=[],k=c(f),l=e(g);if(k){if(b.global)for(;h=b.exec(k);){if(!h[0])throw"findAndReplaceDOMText cannot handle zero-length matches";j.push([b.lastIndex-h[0].length,b.lastIndex,h])}else{if(h=k.match(b),i=k.indexOf(h[0]),!h[0])throw"findAndReplaceDOMText cannot handle zero-length matches";j.push([i,i+h[0].length,h])}a.PNAPI.log("Matches found: "+j.length),j.length&&d(f,j,l)}}function c(a){if(3===a.nodeType)return a.data;var b="";if(a=a.firstChild)do b+=c(a);while(a=a.nextSibling);return b}function d(b,c,d){var e,f,g,h,i,j=[],k=0,l=b,m=c.shift(),n=0,o=a.now()+2e3;a:for(;;){if(a.now()>o){a.PNAPI.warn("SolutionsJS: Could not finish iterating through DOM to replace numbers. Likely you have an invalid DOM structure, or perhaps unclosed tags.",!0);break}if(3===l.nodeType&&(!f&&l.length+k>=m[1]?(f=l,h=m[1]-k):e&&j.push(l),!e&&l.length+k>m[0]&&(e=l,g=m[0]-k),k+=l.length),e&&f){if(i=e.data.indexOf("Invoca.PNAPI.integration")===-1,l=d({startNode:e,startNodeIndex:g,endNode:f,endNodeIndex:h,innerNodes:j,match:m[2],matchIndex:n,shouldUpdate:i}),k-=f.length-h,e=null,f=null,j=[],m=c.shift(),n++,!m)break}else if(l.firstChild||l.nextSibling){l=l.firstChild||l.nextSibling;continue}for(;;){if(l.nextSibling){l=l.nextSibling;break}if(l.parentNode===b)break a;if(a.now()>o)break;l=l.parentNode}}}function e(a){function b(a){var b=document.createTextNode(a);return b}f=[];var c;if("function"!=typeof a){var d=a.nodeType?a:document.createElement(a);c=function(a){var b,c=document.createElement("div");return c.innerHTML=d.outerHTML||(new XMLSerializer).serializeToString(d),b=c.firstChild,a&&b.appendChild(document.createTextNode(a)),b}}else c=a;return function(a){var d=a.startNode,e=a.endNode,g=a.matchIndex;if(d===e){var h=d;if(a.startNodeIndex>0){var i=document.createTextNode(h.data.substring(0,a.startNodeIndex));h.parentNode.insertBefore(i,h)}var j=a.shouldUpdate?c(a.match[0],g):b(a.match[0]);if(h.parentNode.insertBefore(j,h),a.endNodeIndex<h.length){var k=document.createTextNode(h.data.substring(a.endNodeIndex));h.parentNode.insertBefore(k,h)}return h.parentNode.removeChild(h),f.push(function(){var a=j.parentNode;a.insertBefore(j.firstChild,j),a.removeChild(j),a.normalize()}),j}for(var i=document.createTextNode(d.data.substring(0,a.startNodeIndex)),k=document.createTextNode(e.data.substring(a.endNodeIndex)),l=c(d.data.substring(a.startNodeIndex),g),m=[],n=0,o=a.innerNodes.length;n<o;++n){var p=a.innerNodes[n],q=c(p.data,g);p.parentNode.replaceChild(q,p),m.push(q)}var r=c(e.data.substring(0,a.endNodeIndex),g);return d.parentNode.insertBefore(i,d),d.parentNode.insertBefore(l,d),d.parentNode.removeChild(d),e.parentNode.insertBefore(r,e),e.parentNode.insertBefore(k,e),e.parentNode.removeChild(e),f.push(function(){m.unshift(l),m.push(r);for(var a=0,b=m.length;a<b;++a){var c=m[a],d=c.parentNode;d.insertBefore(c.firstChild,c),d.removeChild(c),d.normalize()}}),r}}var f;b.revert=function(){for(var a=0,b=f.length;a<b;++a)f[a]();f=[]},a._DOM.findAndReplaceText=b}(Invoca),function(a,b){"use strict";function c(){if(!f){f=!0;for(var a=0;a<e.length;a++)e[a].fn.call(window,e[a].ctx);e=[]}}function d(){"complete"===document.readyState&&c()}a=a||"docReady",b=b||window;var e=[],f=!1,g=!1;b[a]=function(a,b){return f?void setTimeout(function(){a(b)},1):(e.push({fn:a,ctx:b}),void("complete"===document.readyState||!document.attachEvent&&"interactive"===document.readyState?setTimeout(c,1):g||(document.addEventListener?(document.addEventListener("DOMContentLoaded",c,!1),window.addEventListener("load",c,!1)):(document.attachEvent("onreadystatechange",d),window.attachEvent("onload",c)),g=!0)))}}("ready",Invoca.PNAPI),Invoca._Cache.initialize=function(a){function b(a){var b=new Date,c=a||Invoca.PNAPI.currentPageSettings.cookieDays;return b.setDate(b.getDate()+c),b.toString()}function c(){if(Invoca._Cache.ready){var a=new Date,b=Invoca._Cache.get("ttl")||null,c=new Date(b);a>c&&(Invoca._Cache.resetAllData(),Invoca._Cache.initialize(),Invoca.PNAPI.log("TTL Cleared"))}}function d(){function a(){var a,b;try{b=Invoca.Tools.readCookie("invoca_session"),a=Invoca._Cache.parseCachedData(b),Invoca.PNAPI.log("Migrating old cookie's data: ",a)}catch(c){Invoca.PNAPI.warn("SolutionsJS: unable to migrate old data",c),a={}}return Invoca.Tools.setCookie("invoca_session","",-1),Invoca._Cache.initialize(a),!1}return!Invoca._Cache.shouldCheckOldCookie||(Invoca._Cache.shouldCheckOldCookie=!1,!!Invoca._Cache.read().config||a())}a=a||{},Invoca._Cache.localStorageAvailable=Invoca.PNAPI.currentPageSettings.useLocalStorage&&Invoca._Cache.localStorageAvailable;var e,f={ttl:b(),session:a,config:{campaignIdOverrideParam:null,campaignIdOverrideValue:null,requirementsNeeded:!0,cookieName:"invoca_session"}};Invoca._Cache.localStorageAvailable?localStorage.Invoca?(c(),Invoca._Cache.ready=!0):(e=Invoca._Cache.prepareJSON(f),localStorage.setItem("Invoca",e),Invoca._Cache.ready=!0):Invoca.Tools.readCookie("invoca_session")?d()&&(c(),Invoca._Cache.ready=!0):Invoca._Cache.ready||(e=Invoca._Cache.prepareJSON(f),Invoca.Tools.setCookie("invoca_session",e,Invoca.PNAPI.currentPageSettings.cookieDays),Invoca._Cache.ready=!0)},Invoca._Cache.prepareJSON=function(a){var b=Invoca.JSON.stringify(a),c=encodeURIComponent(b);return c},Invoca._Cache.parseCachedData=function(a){var b,c;try{b=decodeURIComponent(a),c=Invoca.JSON.parse(b)}catch(d){c={}}return c},Invoca._Cache.get=function(a){if(Invoca._Cache.ready){var b=Invoca._Cache.read(),c=a?b[a]:b;return c&&(c.length>0||Invoca.PNAPI.getKeys(c).length>0)?c:{}}Invoca._Cache.initialize(),Invoca._Cache.get(a)},Invoca._Cache.set=function(a,b,c){if(Invoca._Cache.ready){var d,e=Invoca._Cache.get();e[a]||(e[a]={}),e[a][b]=c,d=Invoca._Cache.prepareJSON(e),Invoca._Cache.write(d)}else Invoca._Cache.initialize()},Invoca._Cache.write=function(a){Invoca._Cache.localStorageAvailable?localStorage.setItem("Invoca",a):Invoca.Tools.setCookie("invoca_session",a,Invoca.PNAPI.currentPageSettings.cookieDays)},Invoca._Cache.read=function(){var a=Invoca._Cache.localStorageAvailable?localStorage.getItem("Invoca"):Invoca.Tools.readCookie("invoca_session");return a||(a="{}",Invoca.PNAPI.warn("SolutionsJS: Unable to read cache...check if cookies are enabled")),Invoca._Cache.parseCachedData(a)},Invoca._Cache.saveSessionData=function(a){if(Invoca._Cache.ready){var b,c=Invoca._Cache.get();c.session=a||{},b=Invoca._Cache.prepareJSON(c),Invoca._Cache.write(b)}else Invoca._Cache.initialize()},Invoca._Cache.resetSessionData=function(){Invoca._Cache.sessionCanBeReset&&Invoca._Cache.saveSessionData({}),Invoca._Cache.sessionCanBeReset=!1},Invoca._Cache.resetAllData=function(){Invoca._Cache.localStorageAvailable?localStorage.removeItem("Invoca"):Invoca.Tools.setCookie("invoca_session","",-1),Invoca._Cache.ready=!1},Invoca.PNAPI.data=[],Invoca.PNAPI.display=function(){console.log("\n"),console.log("SolutionsJS 2.0 - Logs:"),console.log("-----------------------"),Invoca.PNAPI.forEach(Invoca.PNAPI.data,function(a,b){console.log(a)})},Invoca.PNAPI.log=function(a){"undefined"!=typeof console&&"undefined"!=typeof console.log&&Invoca.PNAPI.currentPageSettings.debugMode&&console.log(a),Invoca.PNAPI.data.push(a)},Invoca.PNAPI.warn=function(a){"undefined"!=typeof console&&"undefined"!=typeof console.warn&&console.warn(a)},Invoca.PNAPI.extend=function(a,b){var c=a;for(var d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);return c},Invoca.PNAPI.forEach=function(a,b){var c;if(a.constructor===Array)for(c=0;c<a.length;c++)b(a[c],c);else if(a.constructor===Object){var d=Invoca.PNAPI.getKeys(a);for(c=0;c<d.length;c++)b(d[c],a[d[c]],c)}else for(c=0;c<a.length;c++)b(a[c],c)},Invoca.PNAPI.getKeys=function(){"use strict";var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=c.length;return function(e){if("object"!=typeof e&&("function"!=typeof e||null===e))throw new TypeError("Invoca.PNAPI.getKeys called on non-object");var f,g,h=[];for(f in e)a.call(e,f)&&h.push(f);if(b)for(g=0;g<d;g++)a.call(e,c[g])&&h.push(c[g]);return h}}(),Invoca._Refresh.updateOnBlur=function(){window.onblur=function(){"function"==typeof Invoca._Refresh.oldBlur&&Invoca._Refresh.oldBlur(),Invoca.PNAPI.log("Lost focus, pausing number refresh."),Invoca._Refresh.active=!1},window.onfocus=function(){"function"==typeof Invoca._Refresh.oldFocus&&Invoca._Refresh.oldFocus(),Invoca.PNAPI.log("Regained focus, refreshing numbers."),Invoca._Refresh.active||Invoca.PNAPI.doInvoca(),Invoca._Refresh.active=!0}},Invoca._Refresh.getAverageTimeFromResponse=function(a){var b,c=[],d=15,e=null,f=10;return Invoca.PNAPI.forEach(a,function(a,b){a.lifetimeInSeconds&&c.push(a.lifetimeInSeconds)}),c&&c.length>0&&(b=Math.min.apply(Math,c),e=Math.max.apply(Math,[b-f,d])),e},Invoca._Refresh.start=function(a){Invoca._Refresh.firstRun&&(Invoca._Refresh.updateOnBlur(),Invoca._Refresh.firstRun=!1),Invoca._Refresh.lowestWaitTimeSeconds=Invoca._Refresh.getAverageTimeFromResponse(a),Invoca._Refresh.waitTime=1e3*(Invoca._Refresh.lowestWaitTimeSeconds||Invoca.PNAPI.currentPageSettings.refreshTimeSeconds||Invoca._Refresh.defaultWaitTimeSeconds),setTimeout(function(){Invoca._Refresh.active?(Invoca.PNAPI.log("Refreshing phone numbers"),Invoca.PNAPI.doInvoca()):Invoca.PNAPI.log("Skipping refresh")},Invoca._Refresh.waitTime)},Invoca.PNAPI.integration=function(a){if(Invoca.PNAPI.currentPageSettings=Invoca.PNAPI.extend(Invoca.PNAPI.currentPageSettings,a),!Invoca.PNAPI.currentPageSettings.numberSelector&&!Invoca.PNAPI.currentPageSettings.numberToReplace)throw"Invoca: No numberSelector or numberToReplace found!";Invoca._Cache.initialize(),Invoca.PNAPI.ready(Invoca.PNAPI.checkDependencies)},Invoca.PNAPI.checkDependencies=function(){var a=Invoca.Tools.getQueryStringsHash(),b=a.ppcpn||Invoca._Cache.get().ppcpn,c=b&&b.length<=11,d=!!c||Invoca.PNAPI.checkRequiredParams(a);d&&(Invoca._DOM.numberToReplace(),Invoca.PNAPI.doInvoca())},Invoca.PNAPI.checkRequiredParams=function(a){a=a||Invoca.Tools.getQueryStringsHash();var b=Invoca.PNAPI.currentPageSettings.requiredParams?Invoca.PNAPI.getKeys(Invoca.PNAPI.currentPageSettings.requiredParams).length:0,c=0,d=!1,e=Invoca._Cache.get("config"),f=e.requirementsNeeded;if(f&&b>0){for(var g in Invoca.PNAPI.currentPageSettings.requiredParams){var h=Invoca.PNAPI.currentPageSettings.requiredParams[g];(a[g]===h||"*"===h&&Invoca.Tools.contains(Invoca.location,g))&&c++}d=c===b}else d=!0;return Invoca._Cache.set("config","requirementsNeeded",!d),d},Invoca.PNAPI.doInvoca=function(){var a=Invoca._RequestData.get(),b=Invoca._PoolParams.readInvocaSessionData();a.length>0?(Invoca.PNAPI.settings={networkId:Invoca.PNAPI.currentPageSettings.networkId},Invoca.PNAPI.requestPromoNumbers({requestData:a,requestDataSharedParams:b,onComplete:Invoca.PNAPI.onInvocaResponse})):(Invoca.PNAPI.warn("SolutionsJS: No campaign ID's were found"),Invoca.PNAPI.fireCallbacks([{status:"error",message:"no campaign ids were found"}]))},Invoca.PNAPI.onInvocaResponse=function(a,b){if("function"==typeof Invoca.PNAPI.currentPageSettings.onCompleteOverride)Invoca.PNAPI.currentPageSettings.onCompleteOverride(a,b);else{var c=Invoca.PNAPI.transformRequestNumberResponseToHash(b),d=Invoca._DOM.find(Invoca.PNAPI.currentPageSettings.numberSelector),e=b&&b[0]&&b[0].vlData?Invoca._RequestData.staticNumberData(b):null;Invoca.PNAPI.forEach(d,function(a,b){try{var d=e?e:Invoca._RequestData._thisCampaignId(a),f=c[d];if(f&&"success"===f.status){var g=f.formattedNumber;Invoca._DOM.replaceNumbers(a,g)}}catch(h){Invoca.PNAPI.log("Error: "+h.toString())}})}Invoca.PNAPI.fireCallbacks(b),Invoca.PNAPI.currentPageSettings.refresh&&Invoca._Refresh.start(b)},Invoca.PNAPI.fireCallbacks=function(a){"function"==typeof Invoca.PNAPI.currentPageSettings.onComplete&&Invoca.PNAPI.currentPageSettings.onComplete(a)},Invoca._PoolParams.getParams=function(){var a,b=Invoca.Tools.getQueryStringsHash()||{},c=Invoca.PNAPI.currentPageSettings.cookieNames||[];return Invoca.PNAPI.currentPageSettings.params&&Invoca.PNAPI.currentPageSettings.params.length>0&&(Invoca.PNAPI.warn("SolutionsJS Warning: Did you mean to use the 'cookieNames' parameter?"),c.concat(Invoca.PNAPI.currentPageSettings.params)),Invoca.PNAPI.forEach(c,function(c,d){(a=Invoca.Tools.readCookie(c))&&(b[c]=a)}),b=Invoca.PNAPI.extend(b,Invoca.PNAPI.currentPageSettings.poolParams),Invoca._Cache.saveSessionData(b),b},Invoca._PoolParams.readInvocaSessionData=function(){var a=Invoca._Cache.get("session"),b=null,c="object"==typeof a&&Invoca.PNAPI.getKeys(a).length>0;return Invoca.PNAPI.currentPageSettings.savePoolParams&&(Invoca.PNAPI.currentPageSettings.updatePoolParams=!1),c?(b=a,Invoca.PNAPI.currentPageSettings.updatePoolParams&&(b=Invoca.PNAPI.extend(b,Invoca.PNAPI.currentPageSettings.poolParams),Invoca._Cache.saveSessionData(b))):b=Invoca._PoolParams.getParams(),b},Invoca._RequestData.get=function(){var a=[],b=Invoca._RequestData.getCampaignIds();for(var c in b)a.push({request_id:c,advertiser_campaign_id_from_network:c});return a},Invoca._RequestData.getCampaignIds=function(){var a={},b=Invoca._RequestData.checkOverrideParams(),c=Invoca.PNAPI.currentPageSettings.defaultCampaignId;if(Invoca.PNAPI.currentPageSettings.numberToReplace&&Invoca._DOM.numberToReplace(),b)a[b]=!0;else{var d=Invoca._DOM.find(Invoca.PNAPI.currentPageSettings.numberSelector);Invoca.PNAPI.forEach(d,function(b,d){Invoca._DOM.dataset(b,"data-invoca")&&Invoca.PNAPI.warn('Invoca Warning: "data-invoca" tag is not supported! Please use "'+Invoca._DOM.DATA_ATTR_NAME+'".'),thisCampaign=Invoca._RequestData.getDestinationAsId(b)||Invoca._DOM.dataset(b,Invoca._DOM.DATA_ATTR_NAME)||c,null!==thisCampaign&&(a[thisCampaign]=!0)})}return a},Invoca._RequestData.checkOverrideParams=function(){var a=Invoca.PNAPI.currentPageSettings.campaignIdOverrideParam,b=Invoca.Tools.readUrl(Invoca.PNAPI.currentPageSettings.campaignIdOverrideParam),c=Invoca._Cache.get("config").campaignIdOverrideValue||null;return a?b?(Invoca._Cache.set("config","campaignIdOverrideParam",Invoca.PNAPI.currentPageSettings.campaignIdOverrideParam),Invoca._Cache.set("config","campaignIdOverrideValue",b),Invoca._Cache.resetSessionData(),b):c:null},Invoca._RequestData.getDestinationAsId=function(a){function b(a){var b;return(b=Invoca._DOM.dataset(a,Invoca._DOM.DESTINATION_ATTR_NAME))?b:null}function c(a){if(a.innerText||a.textContent){var b=a.innerText||a.textContent;return b=b.toLowerCase().split("x")[0].replace(/[^\d]/g,""),b="1"===b[0]?b.slice(1):b,a.setAttribute(Invoca._DOM.DESTINATION_ATTR_NAME,b),b||null}return null}var d=Invoca.PNAPI.currentPageSettings.destinationAsId&&!Invoca._RequestData.checkOverrideParams();return d?b(a)||c(a):null},Invoca._RequestData.staticNumberData=function(a){var b=a[0].nationalNumber,c=Invoca._Cache.get("session"),d=Invoca.PNAPI.extend(c,{ppcpn:b,vlData:encodeURIComponent(Invoca.JSON.stringify(a[0].vlData))});return Invoca._Cache.saveSessionData(d),a[0].requestId},Invoca._RequestData._thisCampaignId=function(a){var b=Invoca._RequestData.checkOverrideParams(),c=b||Invoca._RequestData.getDestinationAsId(a),d=c||Invoca._DOM.dataset(a,Invoca._DOM.DATA_ATTR_NAME),e=d||Invoca.PNAPI.currentPageSettings.defaultCampaignId;
return e};